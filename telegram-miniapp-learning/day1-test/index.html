<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My First MiniApp</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
        }
        .user-info {
            background: var(--tg-theme-secondary-bg-color, #f1f1f1);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }
        .success {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }
        button {
            background: var(--tg-theme-button-color, #007bff);
            color: var(--tg-theme-button-text-color, white);
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ My First MiniApp</h1>
        
        <div id="environment-info"></div>
        <div id="user-info" class="user-info"></div>
        
        <button id="theme-button">Toggle Theme Info</button>
        <button id="platform-button">Show Platform Info</button>
        
        <div id="additional-info" style="display: none;">
            <h3>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h3>
            <div id="platform-details"></div>
        </div>
    </div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ Telegram WebApp
        function isTelegramWebApp() {
            return window.Telegram && window.Telegram.WebApp;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        let tg = null;
        let isInTelegram = isTelegramWebApp();

        if (isInTelegram) {
            tg = window.Telegram.WebApp;
            tg.ready();
            tg.expand(); // –†–∞—Å—à–∏—Ä—è–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ä–µ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        function updateEnvironmentInfo() {
            const envInfo = document.getElementById('environment-info');
            
            if (isInTelegram) {
                envInfo.innerHTML = `
                    <div class="success">
                        ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤–Ω—É—Ç—Ä–∏ Telegram
                    </div>
                `;
            } else {
                envInfo.innerHTML = `
                    <div class="warning">
                        ‚ö†Ô∏è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ –æ–±—ã—á–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ
                        <br><small>–î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç</small>
                    </div>
                `;
            }
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        function updateUserInfo() {
            const userInfoDiv = document.getElementById('user-info');
            
            if (isInTelegram && tg.initDataUnsafe.user) {
                const user = tg.initDataUnsafe.user;
                userInfoDiv.innerHTML = `
                    <h3>üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:</h3>
                    <p><strong>–ò–º—è:</strong> ${user.first_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</p>
                    <p><strong>–§–∞–º–∏–ª–∏—è:</strong> ${user.last_name || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                    <p><strong>Username:</strong> @${user.username || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                    <p><strong>ID:</strong> ${user.id}</p>
                    <p><strong>–Ø–∑—ã–∫:</strong> ${user.language_code || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                `;
            } else {
                userInfoDiv.innerHTML = `
                    <h3>üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:</h3>
                    <p>üîí –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤ Telegram</p>
                    <p><em>–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –±–æ—Ç –≤ Telegram, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</em></p>
                `;
            }
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–º–µ
        function toggleThemeInfo() {
            if (isInTelegram) {
                alert(`
–¢–µ–º–∞: ${tg.colorScheme}
–¶–≤–µ—Ç —Ñ–æ–Ω–∞: ${tg.themeParams.bg_color || 'default'}
–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞: ${tg.themeParams.text_color || 'default'}
–í–µ—Ä—Å–∏—è: ${tg.version}
–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ${tg.platform}
                `);
            } else {
                alert('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–º–µ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ Telegram');
            }
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
        function togglePlatformInfo() {
            const detailsDiv = document.getElementById('additional-info');
            const platformDiv = document.getElementById('platform-details');
            
            if (detailsDiv.style.display === 'none') {
                detailsDiv.style.display = 'block';
                
                if (isInTelegram) {
                    platformDiv.innerHTML = `
                        <p><strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</strong> ${tg.platform}</p>
                        <p><strong>–í–µ—Ä—Å–∏—è:</strong> ${tg.version}</p>
                        <p><strong>–í—ã—Å–æ—Ç–∞ viewport:</strong> ${tg.viewportHeight}px</p>
                        <p><strong>–°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞:</strong> ${tg.viewportStableHeight}px</p>
                        <p><strong>–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ü–≤–µ—Ç:</strong> ${tg.headerColor}</p>
                        <p><strong>–¶–≤–µ—Ç —Ñ–æ–Ω–∞:</strong> ${tg.backgroundColor}</p>
                    `;
                } else {
                    platformDiv.innerHTML = `
                        <p><strong>User Agent:</strong> ${navigator.userAgent}</p>
                        <p><strong>–Ø–∑—ã–∫:</strong> ${navigator.language}</p>
                        <p><strong>–†–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞:</strong> ${window.screen.width}x${window.screen.height}</p>
                        <p><strong>–†–∞–∑–º–µ—Ä –æ–∫–Ω–∞:</strong> ${window.innerWidth}x${window.innerHeight}</p>
                    `;
                }
            } else {
                detailsDiv.style.display = 'none';
            }
        }

        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Main Button –µ—Å–ª–∏ –º—ã –≤ Telegram
        if (isInTelegram) {
            tg.MainButton.text = "–ó–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ";
            tg.MainButton.show();
            tg.MainButton.onClick(() => {
                tg.close();
            });
        }

        // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.getElementById('theme-button').onclick = toggleThemeInfo;
        document.getElementById('platform-button').onclick = togglePlatformInfo;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        updateEnvironmentInfo();
        updateUserInfo();

        // –õ–æ–≥–∏—Ä—É–µ–º –≤ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        console.log('Is Telegram WebApp:', isInTelegram);
        if (isInTelegram) {
            console.log('Telegram WebApp object:', tg);
            console.log('Init data:', tg.initDataUnsafe);
        }
    </script>
</body>
</html>